<link rel="stylesheet" href="css/fox-listview.css"/>

/*fox-listview*/
<fox-element name="fox-listview" attributes="contentselector">
    <script>
        (function(env){
            var fox = env.fox;
            fox('fox-listview', {
                lifecycle: {
                    created: function() {
                        var foxCss = {};
                        foxCss.menu_swipeLeft = function(){
                            //获得class
                            function getElementsByClassName(_className,_tag){
                                var classElements=[],allElements= arguments.length > 1 ? document.getElementsByTagName(_tag) : document.getElementsByTagName('*');
                                for(var i=0;i<allElements.length;i++){
                                    if(allElements[i].className == _className){
                                        classElements[classElements.length]=allElements[i];
                                    }
                                }
                                return classElements;
                            }
                            /*swipe to show item-menu*/
                            var swipeDoms = getElementsByClassName("swipe-left","a");
                            var touchStart = function(e){
                                isdrag = true;
                                e.preventDefault();
                                var touch = e.touches[0];
                                startX = touch.pageX;
                            };
                            var touchMove = function(e){
                                if (isdrag){
                                    e.preventDefault();//阻止滚动
                                    var touch = e.touches[0];
                                    var x = touch.pageX - startX;
                                    this.style.left = x + 'px';
                                    function getNextElement(node){
                                        if(node.nextSibling.nodeType == 1){    //判断下一个节点类型为1则是“元素”节点
                                            return node.nextSibling;
                                        }
                                        if(node.nextSibling.nodeType == 3){      //判断下一个节点类型为3则是“文本”节点  ，回调自身函数
                                            return getNextElement(node.nextSibling);
                                        }
                                        return null;
                                    }
                                    var menu = getNextElement(this);
                                    var menuW = menu.children.length*70;
                                    if(x <= -menuW){
                                        tl = -menuW + 'px';
                                        isdrag = false;
                                    }else if(x > 0){
                                        isdrag = false;
                                    }else {
                                        isdrag = true;
                                    }
                                }
                            }
                            var L = swipeDoms.length;
                            for(var i = 0; i < L; i++){
                                swipeDoms[i].addEventListener('touchstart',touchStart);
                                swipeDoms[i].addEventListener('touchmove',touchMove);
                                swipeDoms[i].addEventListener('touchend',function(){
                                    isdrag = false;
                                    if(parseInt(this.style.left) > 2){
                                        this.style.left = "0px";
                                    }
                                });
                            }
                        }

                        foxCss.menu_swipeLeft();
                    }
                }
            });
        })(this);
    </script>
    </fox-element>